2025-08-15 05:31:15.451 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 05:31:15.487 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 05:31:15.487 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 05:31:15.487 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 05:31:15.491 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 05:31:15.493 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 05:31:15.493 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 05:31:16.227 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1524': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 13:52:29.850 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 13:52:29.851 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 13:52:29.851 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 13:52:29.851 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 13:52:29.853 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 13:52:29.854 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 13:52:29.854 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 13:52:30.255 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1525': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 13:53:15.276 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 13:53:15.276 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 13:53:15.276 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 13:53:15.276 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 13:53:15.279 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 13:53:15.280 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 13:53:15.280 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 13:53:15.617 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1526': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 13:54:01.340 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 13:54:01.341 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 13:54:01.341 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 13:54:01.341 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 13:54:01.360 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 13:54:01.361 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 13:54:01.362 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 13:54:01.930 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1527': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:03:29.838 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:03:29.841 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:03:29.842 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:03:29.842 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:03:29.945 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:03:29.951 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:03:29.952 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:03:31.125 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1528': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:04:15.188 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:04:15.194 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:04:15.194 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:04:15.194 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:04:15.202 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:04:15.204 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:04:15.204 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:04:15.929 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1529': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:05:15.402 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:05:15.403 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:05:15.403 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:05:15.403 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:05:15.409 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:05:15.416 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:05:15.416 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:05:15.756 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1530': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:06:15.523 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:06:15.526 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:06:15.526 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:06:15.527 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:06:15.572 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:06:15.575 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:06:15.575 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:06:17.792 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1531': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:07:15.609 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:07:15.615 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:07:15.616 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:07:15.616 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:07:15.708 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:07:15.713 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:07:15.713 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:07:16.588 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1532': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:08:15.874 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:08:15.880 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:08:15.880 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:08:15.881 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:08:15.900 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:08:15.902 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:08:15.902 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:08:16.563 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1533': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:09:16.124 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:09:16.125 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:09:16.125 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:09:16.125 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:09:16.142 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:09:16.143 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:09:16.143 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:09:16.716 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1534': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:10:16.138 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:10:16.143 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:10:16.143 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:10:16.143 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:10:16.181 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:10:16.181 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:10:16.181 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:10:16.848 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1535': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:11:16.139 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:11:16.139 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:11:16.139 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:11:16.139 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:11:16.142 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:11:16.143 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:11:16.143 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:11:16.844 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1536': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:12:16.411 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:12:16.413 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:12:16.413 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:12:16.414 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:12:16.469 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:12:16.473 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:12:16.473 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:12:17.465 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1537': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:13:17.061 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:13:17.075 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:13:17.078 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:13:17.078 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:13:17.193 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:13:17.202 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:13:17.203 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:13:19.440 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1538': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:14:18.427 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:14:18.431 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:14:18.432 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:14:18.432 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:14:18.470 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:14:18.471 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:14:18.471 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:14:19.057 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1539': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:15:18.442 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:15:18.450 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:15:18.450 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:15:18.450 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:15:18.467 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:15:18.494 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:15:18.494 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:15:19.225 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1540': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:16:18.466 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:16:18.466 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:16:18.466 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:16:18.466 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:16:18.472 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:16:18.474 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:16:18.474 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:16:19.120 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1541': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:17:18.883 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:17:18.896 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:17:18.897 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:17:18.897 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:17:18.916 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:17:18.921 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:17:18.921 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:17:19.632 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1542': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:18:19.315 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:18:19.316 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:18:19.316 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:18:19.316 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:18:19.357 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:18:19.360 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:18:19.360 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:18:20.088 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1543': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:19:19.666 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:19:19.669 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:19:19.669 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:19:19.669 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:19:19.711 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:19:19.714 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:19:19.714 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:19:20.325 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1544': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:20:04.008 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'AggregatedCounter' table...
2025-08-15 14:20:04.028 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'AggregatedCounter' table...
2025-08-15 14:20:04.028 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Counter' table...
2025-08-15 14:20:04.030 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Counter' table...
2025-08-15 14:20:04.030 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Job' table...
2025-08-15 14:20:04.036 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Job' table...
2025-08-15 14:20:04.036 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'List' table...
2025-08-15 14:20:04.039 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'List' table...
2025-08-15 14:20:04.040 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Set' table...
2025-08-15 14:20:04.042 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Set' table...
2025-08-15 14:20:04.042 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Hash' table...
2025-08-15 14:20:04.044 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Hash' table...
2025-08-15 14:20:04.045 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'State' table...
2025-08-15 14:20:04.053 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'State' table...
2025-08-15 14:20:04.053 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'JobParameter' table...
2025-08-15 14:20:04.075 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'JobParameter' table...
2025-08-15 14:20:19.884 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:20:19.884 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:20:19.885 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:20:19.885 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:20:19.889 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:20:19.891 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:20:19.891 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:20:20.442 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1545': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:21:19.993 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:21:20.000 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:21:20.001 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:21:20.001 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:21:20.093 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:21:20.095 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:21:20.095 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:21:20.726 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1546': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:22:20.434 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:22:20.436 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:22:20.436 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:22:20.436 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:22:20.476 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:22:20.486 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:22:20.486 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:22:21.146 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1547': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:23:05.456 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:23:05.459 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:23:05.460 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:23:05.460 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:23:05.469 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:23:05.481 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:23:05.481 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:23:06.198 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1548': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:24:05.475 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:24:05.476 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:24:05.477 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:24:05.477 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:24:05.540 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:24:05.542 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:24:05.543 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:24:06.581 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1549': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:25:05.568 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:25:05.584 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:25:05.586 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:25:05.586 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:25:05.684 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:25:05.687 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:25:05.687 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:25:06.352 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1550': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:26:09.494 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:26:09.508 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:26:09.508 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:26:09.508 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:26:09.566 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:26:09.573 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:26:09.574 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:26:10.457 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1551': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:27:10.522 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:27:10.540 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:27:10.540 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:27:10.540 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:27:10.748 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:27:10.762 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:27:10.763 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:27:12.526 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1552': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:28:12.581 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:28:12.583 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:28:12.583 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:28:12.583 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:28:12.625 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:28:12.626 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:28:12.626 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:28:13.300 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1553': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:29:13.351 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:29:13.377 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:29:13.377 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:29:13.378 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:29:13.487 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:29:13.489 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:29:13.489 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:29:14.334 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1554': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:30:14.389 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:30:14.393 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:30:14.393 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:30:14.394 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:30:14.417 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:30:14.420 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:30:14.421 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:30:15.184 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1555': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:31:15.218 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:31:15.219 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:31:15.219 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:31:15.219 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:31:15.283 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:31:15.284 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:31:15.284 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:31:15.997 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1556': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:32:16.028 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:32:16.029 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:32:16.030 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:32:16.030 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:32:16.073 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:32:16.076 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:32:16.076 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:32:17.119 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1557': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:33:17.163 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:33:17.169 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:33:17.169 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:33:17.169 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:33:17.197 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:33:17.205 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:33:17.205 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:33:19.132 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1558': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:34:19.175 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:34:19.176 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:34:19.176 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:34:19.176 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:34:19.242 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:34:19.246 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:34:19.246 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:34:19.909 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1559': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:35:19.950 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:35:19.952 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:35:19.953 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:35:19.953 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:35:20.015 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:35:20.018 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:35:20.019 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:35:20.936 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1560': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:36:21.113 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:36:21.117 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:36:21.118 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:36:21.118 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:36:21.162 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:36:21.170 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:36:21.170 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:36:21.881 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1561': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:51:58.536 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:51:58.543 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:51:58.543 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:51:58.544 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:51:58.669 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:51:58.678 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:51:58.678 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:51:59.763 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1562': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:52:14.792 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:52:14.794 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:52:14.794 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:52:14.795 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:52:14.806 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:52:14.809 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:52:14.809 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:52:15.454 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1563': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync()
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:53:03.039 +02:00 [INF] Hangfire.BackgroundJobServer Starting Hangfire Server using job storage: 'Database path: hangfire_taskqueue,  prefix: hangfire'
2025-08-15 14:53:03.355 +02:00 [INF] Hangfire.BackgroundJobServer Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-15 14:53:03.646 +02:00 [INF] Hangfire.Server.BackgroundServerProcess Server mbp-von-erlend:23297:c19d8895 successfully announced in 249,438 ms
2025-08-15 14:53:03.653 +02:00 [INF] Hangfire.Server.BackgroundServerProcess Server mbp-von-erlend:23297:c19d8895 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-15 14:53:03.662 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'AggregatedCounter' table...
2025-08-15 14:53:03.689 +02:00 [INF] Hangfire.Server.BackgroundServerProcess Server mbp-von-erlend:23297:c19d8895 all the dispatchers started
2025-08-15 14:53:03.692 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'AggregatedCounter' table...
2025-08-15 14:53:03.692 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Counter' table...
2025-08-15 14:53:03.699 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Counter' table...
2025-08-15 14:53:03.699 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Job' table...
2025-08-15 14:53:03.703 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Job' table...
2025-08-15 14:53:03.703 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'List' table...
2025-08-15 14:53:03.706 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'List' table...
2025-08-15 14:53:03.706 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Set' table...
2025-08-15 14:53:03.709 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Set' table...
2025-08-15 14:53:03.709 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Hash' table...
2025-08-15 14:53:03.711 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Hash' table...
2025-08-15 14:53:03.712 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'State' table...
2025-08-15 14:53:03.716 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'State' table...
2025-08-15 14:53:03.716 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'JobParameter' table...
2025-08-15 14:53:03.725 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'JobParameter' table...
2025-08-15 14:53:18.731 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:53:18.917 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:53:18.918 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:53:18.919 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:53:20.751 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:53:20.833 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:53:20.833 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:53:21.062 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1564': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:53:54.145 +02:00 [INF] Hangfire.Server.BackgroundServerProcess Server mbp-von-erlend:23297:c19d8895 caught stopping signal...
2025-08-15 14:53:54.151 +02:00 [INF] Hangfire.Server.BackgroundServerProcess Server mbp-von-erlend:23297:c19d8895 All dispatchers stopped
2025-08-15 14:53:54.155 +02:00 [INF] Hangfire.Server.BackgroundServerProcess Server mbp-von-erlend:23297:c19d8895 successfully reported itself as stopped in 0,8329 ms
2025-08-15 14:53:54.155 +02:00 [INF] Hangfire.Server.BackgroundServerProcess Server mbp-von-erlend:23297:c19d8895 has been stopped in total 8,7638 ms
2025-08-15 14:54:06.165 +02:00 [INF] Hangfire.BackgroundJobServer Starting Hangfire Server using job storage: 'Database path: hangfire_taskqueue,  prefix: hangfire'
2025-08-15 14:54:06.272 +02:00 [INF] Hangfire.BackgroundJobServer Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-15 14:54:06.560 +02:00 [INF] Hangfire.Server.BackgroundServerProcess Server mbp-von-erlend:23321:e23b6913 successfully announced in 251,5213 ms
2025-08-15 14:54:06.564 +02:00 [INF] Hangfire.Server.BackgroundServerProcess Server mbp-von-erlend:23321:e23b6913 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-15 14:54:06.574 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'AggregatedCounter' table...
2025-08-15 14:54:06.596 +02:00 [INF] Hangfire.Server.BackgroundServerProcess Server mbp-von-erlend:23321:e23b6913 all the dispatchers started
2025-08-15 14:54:06.600 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'AggregatedCounter' table...
2025-08-15 14:54:06.600 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Counter' table...
2025-08-15 14:54:06.603 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Counter' table...
2025-08-15 14:54:06.603 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Job' table...
2025-08-15 14:54:06.607 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Job' table...
2025-08-15 14:54:06.608 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'List' table...
2025-08-15 14:54:06.612 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'List' table...
2025-08-15 14:54:06.612 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Set' table...
2025-08-15 14:54:06.615 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Set' table...
2025-08-15 14:54:06.615 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'Hash' table...
2025-08-15 14:54:06.616 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'Hash' table...
2025-08-15 14:54:06.616 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'State' table...
2025-08-15 14:54:06.618 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'State' table...
2025-08-15 14:54:06.618 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Removing outdated records from the 'JobParameter' table...
2025-08-15 14:54:06.621 +02:00 [INF] Hangfire.Storage.SQLite.ExpirationManager Outdated records removed from the 'JobParameter' table...
2025-08-15 14:54:21.643 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:54:21.835 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:54:21.837 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:54:21.839 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:54:24.426 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:54:24.548 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:54:24.548 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:54:25.031 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1565': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntryNotifier.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:54:35.142 +02:00 [WRN] Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware Failed to determine the https port for redirect.
2025-08-15 14:54:44.190 +02:00 [WRN] Microsoft.EntityFrameworkCore.Query Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-15 14:55:10.110 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:55:10.111 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:55:10.112 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:55:10.112 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:55:10.114 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:55:10.115 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:55:10.115 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:55:10.119 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1566': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:55:52.031 +02:00 [WRN] Microsoft.EntityFrameworkCore.Query Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-15 14:56:10.136 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:56:10.137 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:56:10.138 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:56:10.138 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:56:10.140 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:56:10.140 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:56:10.141 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:56:10.144 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1567': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:57:10.158 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:57:10.158 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:57:10.159 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:57:10.159 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:57:10.161 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:57:10.161 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:57:10.161 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:57:10.165 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1568': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:58:10.185 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:58:10.186 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:58:10.186 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:58:10.186 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:58:10.188 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:58:10.189 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:58:10.189 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:58:10.192 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1569': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 14:59:06.579 +02:00 [INF] Hangfire.Server.ServerWatchdog 1 servers were removed due to timeout
2025-08-15 14:59:10.214 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 14:59:10.215 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 14:59:10.215 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 14:59:10.215 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 14:59:10.217 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 14:59:10.217 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 14:59:10.217 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 14:59:10.220 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1570': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:00:10.233 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:00:10.234 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:00:10.234 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:00:10.234 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:00:10.235 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:00:10.236 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:00:10.236 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:00:10.238 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1571': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:01:10.258 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:01:10.259 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:01:10.259 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:01:10.259 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:01:10.261 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:01:10.262 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:01:10.262 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:01:10.264 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1572': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:02:10.285 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:02:10.286 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:02:10.286 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:02:10.286 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:02:10.288 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:02:10.288 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:02:10.288 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:02:10.291 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1573': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:03:10.314 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:03:10.315 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:03:10.315 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:03:10.315 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:03:10.317 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:03:10.318 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:03:10.318 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:03:10.320 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1574': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:04:10.343 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:04:10.343 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:04:10.344 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:04:10.344 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:04:10.346 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:04:10.346 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:04:10.346 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:04:10.349 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1575': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:05:10.373 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:05:10.374 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:05:10.374 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:05:10.374 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:05:10.376 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:05:10.376 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:05:10.376 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:05:10.379 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1576': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:06:10.400 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:06:10.401 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:06:10.401 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:06:10.401 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:06:10.403 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:06:10.403 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:06:10.403 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:06:10.406 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1577': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:07:10.430 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:07:10.430 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:07:10.430 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:07:10.430 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:07:10.432 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:07:10.433 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:07:10.433 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:07:10.435 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1578': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:08:10.463 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:08:10.464 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:08:10.464 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:08:10.464 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:08:10.465 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:08:10.466 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:08:10.466 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:08:10.469 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1579': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:09:10.487 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:09:10.487 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:09:10.487 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:09:10.488 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:09:10.489 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:09:10.490 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:09:10.490 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:09:10.492 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1580': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:10:10.515 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:10:10.516 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:10:10.516 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:10:10.516 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:10:10.517 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:10:10.518 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:10:10.518 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:10:10.521 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1581': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:11:10.541 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:11:10.542 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:11:10.542 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:11:10.542 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:11:10.544 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:11:10.544 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:11:10.544 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:11:10.546 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1582': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:12:10.567 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:12:10.567 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:12:10.567 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:12:10.567 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:12:10.569 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:12:10.569 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:12:10.569 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:12:10.572 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1583': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:13:10.595 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:13:10.595 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:13:10.595 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:13:10.596 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:13:10.597 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:13:10.598 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:13:10.598 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:13:10.600 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1584': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:14:10.616 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:14:10.616 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:14:10.616 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:14:10.616 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:14:10.618 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:14:10.618 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:14:10.618 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:14:10.620 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1585': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:15:10.645 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:15:10.645 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:15:10.646 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:15:10.646 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:15:10.648 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:15:10.648 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:15:10.648 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:15:10.651 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1586': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:16:10.676 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:16:10.677 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:16:10.677 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:16:10.677 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:16:10.679 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:16:10.680 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:16:10.680 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:16:10.683 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1587': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:17:10.702 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:17:10.702 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:17:10.703 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:17:10.703 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:17:10.705 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:17:10.706 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:17:10.706 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:17:10.708 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1588': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:18:10.730 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:18:10.731 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:18:10.731 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:18:10.731 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:18:10.733 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:18:10.733 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:18:10.733 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:18:10.736 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1589': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:19:10.750 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:19:10.751 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:19:10.751 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:19:10.751 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:19:10.753 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:19:10.753 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:19:10.753 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:19:10.759 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1590': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:20:10.779 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:20:10.779 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:20:10.779 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:20:10.779 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:20:10.782 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:20:10.790 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:20:10.790 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:20:10.794 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1591': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:21:10.813 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:21:10.814 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:21:10.814 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:21:10.814 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:21:10.815 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:21:10.816 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:21:10.816 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:21:10.819 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1592': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:22:10.832 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:22:10.833 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:22:10.833 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:22:10.833 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:22:10.836 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:22:10.837 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:22:10.837 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:22:10.840 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1593': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:23:10.882 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:23:10.883 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:23:10.883 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:23:10.883 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:23:10.903 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:23:10.912 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:23:10.912 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:23:10.941 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1594': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:24:10.987 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:24:10.992 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:24:10.992 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:24:10.992 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:24:10.996 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:24:10.998 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:24:10.998 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:24:11.010 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1595': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.ChangeTracking.ChangeTracker.DetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.TryDetectChanges()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:25:11.054 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:25:11.057 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:25:11.057 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:25:11.057 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:25:11.083 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:25:11.089 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:25:11.089 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:25:11.103 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1596': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:26:11.208 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:26:11.212 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:26:11.212 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:26:11.212 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:26:11.227 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:26:11.228 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:26:11.228 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:26:11.238 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1597': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:27:11.264 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:27:11.264 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:27:11.264 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:27:11.264 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:27:11.279 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:27:11.280 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:27:11.280 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:27:11.288 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1598': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:28:11.552 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:28:11.552 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:28:11.552 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:28:11.552 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:28:11.557 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:28:11.557 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:28:11.557 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:28:11.561 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1599': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:29:11.600 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:29:11.602 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:29:11.602 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:29:11.602 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:29:11.616 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:29:11.617 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:29:11.617 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:29:11.627 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1600': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:30:12.288 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:30:12.289 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:30:12.289 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:30:12.289 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:30:12.294 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:30:12.295 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:30:12.295 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:30:12.299 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1601': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:31:12.316 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:31:12.317 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:31:12.317 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:31:12.317 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:31:12.318 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:31:12.319 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:31:12.319 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:31:12.322 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1602': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:32:12.344 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:32:12.345 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:32:12.345 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:32:12.345 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:32:12.348 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:32:12.348 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:32:12.349 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:32:12.351 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1603': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:33:12.368 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:33:12.368 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:33:12.368 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:33:12.368 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:33:12.370 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:33:12.370 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:33:12.370 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:33:12.373 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1604': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:34:12.445 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:34:12.446 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:34:12.446 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:34:12.446 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:34:12.450 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:34:12.451 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:34:12.451 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:34:12.457 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1605': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:35:12.501 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:35:12.509 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:35:12.509 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:35:12.509 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:35:12.513 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:35:12.514 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:35:12.514 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:35:12.516 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1606': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:36:12.535 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:36:12.536 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:36:12.536 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:36:12.536 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:36:12.538 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:36:12.538 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:36:12.538 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:36:12.542 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1607': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:37:12.560 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:37:12.560 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:37:12.560 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:37:12.560 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:37:12.563 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:37:12.563 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:37:12.563 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:37:12.565 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1608': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:38:12.592 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:38:12.600 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:38:12.600 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:38:12.600 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:38:12.603 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:38:12.603 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:38:12.603 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:38:12.607 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1609': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:39:12.629 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:39:12.632 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:39:12.632 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:39:12.633 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:39:12.639 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:39:12.640 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:39:12.640 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:39:12.646 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1610': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:40:12.689 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:40:12.690 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:40:12.690 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:40:12.690 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:40:12.694 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:40:12.694 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:40:12.694 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:40:12.697 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1611': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:41:12.723 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:41:12.727 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:41:12.730 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:41:12.730 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:41:12.744 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:41:12.744 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:41:12.744 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:41:12.746 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1612': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:42:13.072 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:42:13.072 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:42:13.072 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:42:13.072 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:42:13.077 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:42:13.077 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:42:13.078 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:42:13.080 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1613': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:43:13.273 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:43:13.273 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:43:13.273 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:43:13.273 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:43:13.281 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:43:13.282 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:43:13.282 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:43:13.286 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1614': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:44:13.552 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:44:13.556 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:44:13.556 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:44:13.556 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:44:13.558 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:44:13.561 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:44:13.561 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:44:13.567 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1615': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:45:13.597 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:45:13.601 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:45:13.601 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:45:13.601 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:45:13.604 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:45:13.604 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:45:13.604 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:45:13.606 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1616': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:46:13.647 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:46:13.650 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:46:13.650 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:46:13.650 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:46:13.657 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:46:13.658 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:46:13.658 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:46:13.666 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1617': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:47:13.689 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:47:13.689 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:47:13.689 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:47:13.689 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:47:13.716 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:47:13.717 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:47:13.717 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:47:13.726 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1618': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:48:13.753 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:48:13.753 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:48:13.754 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:48:13.754 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:48:13.758 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:48:13.759 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:48:13.759 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:48:13.764 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1619': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:49:13.785 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:49:13.786 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:49:13.786 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:49:13.786 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:49:13.787 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:49:13.788 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:49:13.788 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:49:13.792 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1620': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 15:50:13.812 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 15:50:13.814 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 15:50:13.815 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 15:50:13.815 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 15:50:13.817 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 15:50:13.817 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 15:50:13.817 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 15:50:13.820 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1621': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 17:50:36.855 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 17:50:36.858 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 17:50:36.858 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 17:50:36.858 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 17:50:36.874 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 17:50:36.876 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 17:50:36.876 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 17:50:36.884 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1622': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2025-08-15 21:50:46.479 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Start
2025-08-15 21:50:46.485 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Get food items from API
2025-08-15 21:50:46.485 +02:00 [INF] calcalc.Services.MattilsynetAPIServiceMock Getting items from mock!
2025-08-15 21:50:46.485 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Got food items from API
2025-08-15 21:50:46.498 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding food items to database
2025-08-15 21:50:46.503 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Done adding food items to database, added 0
2025-08-15 21:50:46.503 +02:00 [INF] calcalc.BackgroundJobs.MattilsynetSync MattilsynetSync: Adding units to food items to database
2025-08-15 21:50:46.509 +02:00 [ERR] Hangfire.AutomaticRetryAttribute Failed to process the job '1623': an exception occurred.
System.InvalidOperationException: The instance of entity type 'FoodHasUnit' cannot be tracked because another instance with the same key value for {'FoodItemId', 'FoodUnitId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.NavigationCollectionChanged(InternalEntityEntry entry, INavigationBase navigationBase, IEnumerable`1 added, IEnumerable`1 removed)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectNavigationChange(InternalEntityEntry entry, INavigationBase navigationBase)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.LocalDetectChanges(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectChanges(IStateManager stateManager)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 112
   at calcalc.BackgroundJobs.MattilsynetSync.DoSync() in /Users/erlend/Documents/calcalc/calcalc/BackgroundJobs/MattilsynetSync.cs:line 116
   at InvokeStub_TaskAwaiter.GetResult(Object, Object, IntPtr*)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
